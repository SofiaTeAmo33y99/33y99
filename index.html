<!DOCTYPE html> 
<html lang="es"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> 
    <title>Para Sof铆a わ</title> 
     
    <!-- Iconos y Fuentes --> 
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600;800&family=Orbitron:wght@500;700&family=Great+Vibes&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> 
     
    <!-- Favicons del usuario --> 
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon-56e4e05b09.png"> 
    <link rel="icon" type="image/png" href="img/favicon-black.ico" sizes="32x32"> 
    <link rel="icon" type="image/png" href="img/favicon-black.ico" sizes="16x16"> 
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
     
    <style> 
        :root { 
            --neon-pink: #ff007f; 
            --neon-gold: #ffd700; 
        } 
 
        body { 
            margin: 0; 
            overflow: hidden; /* Se desbloquea al final */ 
            background-color: #000; 
            font-family: 'Montserrat', sans-serif; 
            color: white; 
            user-select: none; 
        } 
 
        #canvas-container { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 1; 
        } 
 
        /* --- UI INICIAL --- */ 
        #ui-layer { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 10; 
            pointer-events: none; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            flex-direction: column; 
        } 
 
        .text-slide { 
            position: absolute; 
            opacity: 0; 
            transform: translateY(20px); 
            transition: opacity 1s ease, transform 1s ease; 
            width: 80%; 
            max-width: 600px; 
            text-align: center; 
            pointer-events: none; 
        } 
 
        .text-slide.active { 
            opacity: 1; 
            transform: translateY(0); 
            pointer-events: auto; 
        } 
 
        h1 { 
            font-weight: 800; 
            font-size: 2.2rem; 
            text-shadow: 0 0 10px rgba(255, 0, 127, 0.7); 
            margin-bottom: 20px; 
        } 
 
        p { 
            font-size: 1.1rem; 
            font-weight: 300; 
            line-height: 1.6; 
            text-shadow: 0 0 5px rgba(0,0,0,0.8); 
        } 
 
        /* --- BOTONES SI/NO --- */ 
        .btn-container { 
            display: flex; 
            gap: 20px; 
            justify-content: center; 
            margin-top: 30px; 
            pointer-events: auto; 
        } 
 
        .btn { 
            padding: 15px 40px; 
            font-size: 1.2rem; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer; 
            transition: transform 0.2s, box-shadow 0.2s; 
            font-weight: bold; 
            text-transform: uppercase; 
        } 
 
        .btn-yes { 
            background: linear-gradient(45deg, var(--neon-pink), var(--neon-gold)); 
            color: white; 
            box-shadow: 0 0 15px rgba(255, 0, 127, 0.5); 
        } 
 
        .btn-no { 
            background: #333; 
            color: #888; 
        } 
 
        .btn:hover { transform: scale(1.1); } 
 
        /* --- CONSOLA HACKER PINK --- */ 
        #hacker-console { 
            position: fixed; 
            top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0, 0, 0, 0.95); 
            font-family: 'Orbitron', monospace; 
            color: var(--neon-pink); 
            font-size: 1rem; 
            padding: 20px; 
            box-sizing: border-box; 
            display: none; /* Se activa con JS */ 
            z-index: 50; 
            overflow: hidden; 
            text-shadow: 0 0 5px var(--neon-pink); 
        } 
        .console-line { margin-bottom: 5px; opacity: 0; animation: fadeInLine 0.1s forwards; } 
        @keyframes fadeInLine { to { opacity: 1; } } 
        .data-highlight { color: var(--neon-gold); } 
 
        /* --- CONTENEDOR FINAL CON SCROLL --- */ 
        #final-scroll-container { 
            display: none; /* Se activa tras el hackeo */ 
            position: fixed; 
            top: 0; left: 0; width: 100%; height: 100%; 
            z-index: 20; 
            overflow-y: auto; 
            scroll-behavior: smooth; 
            background: rgba(0,0,0,0.6); 
            backdrop-filter: blur(5px); 
        } 
 
        .section { 
            min-height: 90vh; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            padding: 40px 20px; 
            text-align: center; 
            border-bottom: 1px solid rgba(255,255,255,0.1); 
        } 
 
        /* Secci贸n 1: Perd贸n + Logos */ 
        .logos-container { 
            display: flex; 
            gap: 20px; 
            font-size: 3rem; 
            margin: 20px 0; 
            align-items: center; 
        } 
        .logo-rave { 
            font-family: 'Orbitron', sans-serif; 
            font-weight: 700; 
            background: -webkit-linear-gradient(#fff, #666); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
        } 
 
        /* Secci贸n 2: Cron贸metro */ 
        .countdown-wrapper { 
            background: rgba(255, 0, 127, 0.1); 
            padding: 30px; 
            border-radius: 20px; 
            border: 2px solid var(--neon-pink); 
            box-shadow: 0 0 20px var(--neon-pink); 
            position: relative; 
        } 
        .countdown-time { 
            font-family: 'Orbitron', monospace; 
            font-size: 3rem; 
            color: var(--neon-gold); 
        } 
        .roses-decor { font-size: 2rem; margin: 10px; } 
 
        /* Secci贸n 3: Gatos */ 
        .cats-container { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 20px; 
            margin: 20px 0; 
        } 
        .cat-gif { 
            width: 200px; 
            height: auto; 
            border-radius: 15px; 
            box-shadow: 0 0 15px var(--neon-pink); 
        } 
        .love-text-big { 
            font-family: 'Great Vibes', cursive; 
            font-size: 4rem; 
            color: var(--neon-pink); 
            margin-top: 20px; 
        } 
 
        /* Secci贸n 4: Tickets 3D */ 
        .tickets-grid { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 30px; 
            perspective: 1000px; /* Para el 3D */ 
            max-width: 1000px; 
        } 
 
        .ticket-card { 
            width: 280px; 
            height: 160px; 
            background: linear-gradient(135deg, #1a1a1a, #000); 
            border: 2px solid #333; 
            border-radius: 15px; 
            position: relative; 
            transform-style: preserve-3d; 
            transition: transform 0.5s ease; 
            cursor: pointer; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.5); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 20px; 
            color: white; 
            font-family: 'Montserrat', sans-serif; 
            text-transform: uppercase; 
            font-size: 0.9rem; 
            font-weight: 600; 
        } 
 
        .ticket-card:hover { 
            transform: rotateX(20deg) rotateY(10deg) scale(1.05); 
            border-color: var(--neon-pink); 
            box-shadow: 0 0 25px rgba(255, 0, 127, 0.4); 
        } 
 
        .ticket-card::before { 
            content: ''; 
            position: absolute; 
            left: 10px; top: 10px; right: 10px; bottom: 10px; 
            border: 1px dashed rgba(255,255,255,0.3); 
            border-radius: 10px; 
        } 
         
        .ticket-card i { 
            font-size: 2rem; 
            margin-bottom: 10px; 
            display: block; 
            color: var(--neon-pink); 
        } 
 
        /* Ticket Dorado */ 
        .ticket-gold { 
            background: linear-gradient(135deg, #ffd700, #ffaa00); 
            border: 2px solid #fff; 
            color: #000; 
            text-shadow: none; 
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); 
        } 
        .ticket-gold:hover { 
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.9); 
            border-color: #fff; 
        } 
        .ticket-gold i { color: #000; } 
 
        /* Bot贸n Quemar */ 
        .burn-btn { 
            background: linear-gradient(to bottom, #ff4d4d, #990000); 
            color: white; 
            font-family: 'Orbitron', sans-serif; 
            padding: 20px 50px; 
            font-size: 1.5rem; 
            border: 2px solid #ff0000; 
            border-radius: 10px; 
            cursor: pointer; 
            margin-top: 30px; 
            box-shadow: 0 0 20px #ff0000; 
            animation: pulse 1s infinite; 
        } 
 
        @keyframes pulse { 
            0% { transform: scale(1); box-shadow: 0 0 20px #ff0000; } 
            50% { transform: scale(1.05); box-shadow: 0 0 40px #ff0000; } 
            100% { transform: scale(1); box-shadow: 0 0 20px #ff0000; } 
        } 
 
        .scroll-hint { 
            position: absolute; 
            bottom: 30px; 
            left: 50%; 
            transform: translateX(-50%); 
            color: rgba(255,255,255,0.5); 
            font-size: 0.9rem; 
            animation: bounce 2s infinite; 
            pointer-events: none; 
        } 
 
        @keyframes bounce { 0%, 100% { transform: translate(-50%, 0); } 50% { transform: translate(-50%, 10px); } } 
 
        /* Efecto Quemado */ 
        .burning { animation: burn 2.5s forwards ease-in; } 
        @keyframes burn { 
            0% { filter: contrast(100%) hue-rotate(0deg); opacity: 1; } 
            50% { filter: contrast(200%) hue-rotate(-40deg) blur(2px); opacity: 0.8; } 
            100% { filter: contrast(500%) hue-rotate(-90deg) blur(20px); opacity: 0; transform: scale(1.2); background:white; } 
        } 
 
        @media (max-width: 768px) { 
            h1 { font-size: 1.5rem; } 
            .logos-container { font-size: 2rem; } 
            .countdown-time { font-size: 2rem; } 
            .cat-gif { width: 140px; } 
            .ticket-card { width: 90%; height: 120px; } 
        } 

        /* --- SCROLLBAR PERSONALIZADA --- */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--neon-pink), var(--neon-gold));
            border-radius: 10px;
            border: 2px solid #000;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-pink);
            box-shadow: 0 0 10px var(--neon-pink);
        }

        #final-scroll-container::-webkit-scrollbar {
            width: 8px;
        }
    </style> 
</head> 
<body> 
 
    <div id="canvas-container"></div> 
 
    <!-- UI LAYER (Historia inicial) --> 
    <div id="ui-layer"> 
        <!-- Escena 1 --> 
        <div class="text-slide active" id="slide-0"> 
            <h1>驴Por qu茅 no entend茅s que mi amor por vos es muy grande?</h1> 
            <p>NO QUIERO A NADIE MAS QUE NO SEA VOS...</p> 
        </div> 
 
        <!-- Escena 2 --> 
        <div class="text-slide" id="slide-1"> 
            <h1>Si tuviera que explicarlo...</h1> 
            <p>No podr铆a. Pero es algo como los quartsks</p> 
            <p>Pero puedo mostrarte algo de eso.</p> 
        </div> 
 
        <!-- Escena 3 --> 
        <div class="text-slide" id="slide-2"> 
            <h1>Sos mi universo entero.</h1> 
            <p>Si no estas vos, Voy a volver a sentirme vacio</p> 
        </div> 
 
        <!-- Escena 4 --> 
        <div class="text-slide" id="slide-3"> 
            <h1>Estamos destinados, gorda.</h1> 
            <p>Est谩 en nuestro ADN, No nos peliemos, por favor.</p> 
        </div> 

        <!-- Escena 5: Pregunta --> 
        <div class="text-slide" id="slide-4"> 
            <h1>驴Me segu铆s amando?</h1> 
            <div class="btn-container"> 
                <button class="btn btn-yes" id="btn-yes">S</button> 
                <button class="btn btn-no" id="btn-no">NO</button> 
            </div> 
        </div> 
         
        <div class="scroll-hint" id="scroll-hint">Desliz谩 hacia abajo <i class="fas fa-chevron-down"></i></div> 
    </div> 
 
    <!-- CONSOLA HACKER --> 
    <div id="hacker-console"> 
        <div style="text-align:center; margin-bottom: 20px;"> 
            <i class="fas fa-biohazard fa-3x" style="animation: spin 2s infinite linear"></i> 
            <h2 style="margin:5px 0">SYSTEM OVERRIDE</h2> 
        </div> 
        <div id="console-output"></div> 
    </div> 
 
    <!-- INTERFAZ FINAL (Secciones) --> 
    <div id="final-scroll-container"> 
         
        <!-- Secci贸n 1: Perd贸n + Burn --> 
        <div class="section"> 
            <h1>Perd贸n bb te amo</h1> 
            <div class="logos-container"> 
                <i class="fab fa-instagram" style="color: #E1306C;"></i> 
                <span class="logo-rave">RAVE</span> 
            </div> 
            <p>Vamos a empezar de cero. Destruyamos lo malo.</p> 
            <button class="burn-btn" id="btn-burn">{ QUEMAR }</button> 
        </div> 
 
        <!-- Secci贸n 2: Cron贸metro --> 
        <div class="section"> 
            <div class="countdown-wrapper"> 
                <div class="roses-decor"> わ </div> 
                <div class="countdown-time" id="countdown">43 DAS</div> 
                <div class="roses-decor"> わ </div> 
                <p>Para nuestro momento especial.</p> 
            </div> 
        </div> 
 
        <!-- Secci贸n 3: Gatos Animados --> 
        <div class="section" id="section-cats"> 
            <div style="position: relative; width: 100%; height: 400px;">
                <canvas id="cats-canvas" style="width: 100%; height: 100%;"></canvas>
            </div>
            <div class="love-text-big">SOFIA TE AMO</div> 
        </div> 
 
        <!-- Secci贸n 4: Tickets --> 
        <div class="section"> 
            <h2 style="margin-bottom:40px; text-shadow: 0 0 10px white;">TICKETS DE RECONCILIACIN</h2> 
            <div class="tickets-grid"> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-cookie-bite"></i> 
                        Ticket para que te chupe el chikitito 
                    </div> 
                </div> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-baby-carriage"></i> 
                        Ticket para llenarte la fabrica de beb茅s 
                    </div> 
                </div> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-film"></i> 
                        Ticket para ir al cine 
                    </div> 
                </div> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-walking"></i> 
                        Ticket para salir caminar 
                    </div> 
                </div> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-utensils"></i> 
                        Ticket para salir a comer juntos 
                    </div> 
                </div> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-gem"></i> 
                        Ticket para que te regale algo caro muy caro 
                    </div> 
                </div> 
                <div class="ticket-card"> 
                    <div> 
                        <i class="fas fa-hotel"></i> 
                        Ticket para ir a un hotel 
                    </div> 
                </div> 
                <!-- Ticket Dorado --> 
                <div class="ticket-card ticket-gold"> 
                    <div> 
                        <i class="fas fa-crown"></i> 
                        Ticket DORADO para ser novios sin poder decir NO 
                    </div> 
                </div> 
            </div> 
            <p style="margin-top: 30px; color: var(--neon-gold); font-weight: bold;">
                * V谩lidas para despu茅s del 20 de marzo con 1 semana antes de reservaci贸n.
            </p>
        </div> 

        <!-- Secci贸n 5: V铆deo Final -->
        <div class="section">
            <div style="max-width: 800px; width: 100%; border-radius: 20px; overflow: hidden; box-shadow: 0 0 30px var(--neon-pink);">
                <video src="gatito.mp4" autoplay loop muted playsinline style="width: 100%; display: block;"></video>
            </div>
            <button class="btn btn-yes" style="margin-top: 40px; padding: 20px 30px; font-size: 1rem; text-transform: none; border-radius: 15px; width: 90%; max-width: 600px; line-height: 1.4;">
                Me perdonas mi vida, Prometo por mi mama que no estoy viendome con nadie, No estoy traicionadote, Te amo con toda mi vida gorda.
            </button>
        </div>
 
        <div style="height: 100px;"></div> <!-- Espacio extra al final --> 
    </div> 
 
    <!-- SCRIPTS --> 
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script> 
    <script type="importmap"> 
        { 
            "imports": { 
                "three": "https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.module.js", 
                "gsap": "https://unpkg.com/gsap@3.12.2/index.js" 
            } 
        } 
    </script> 
 
    <script type="module"> 
        import * as THREE from 'three'; 
        import { gsap } from 'gsap'; 
 
        // --- 1. CONFIGURACIN THREE.JS --- 
        const container = document.getElementById('canvas-container'); 
        const scene = new THREE.Scene(); 
        scene.background = new THREE.Color(0x000000);
        scene.fog = new THREE.FogExp2(0x000000, 0.001); 
 
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000); 
        camera.position.z = 35; 
 
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true }); 
        renderer.setSize(window.innerWidth, window.innerHeight); 
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); 
        container.appendChild(renderer.domElement); 
 
        // --- 2. SISTEMA DE PARTCULAS PRO --- 
        const particlesCount = 25000; 
        const geometry = new THREE.BufferGeometry(); 
        const positions = new Float32Array(particlesCount * 3); 
        const colors = new Float32Array(particlesCount * 3); 
        const sizes = new Float32Array(particlesCount); 
 
        const shapeHeart = []; 
        const shapeStar = []; 
        const shapeGalaxy = []; 
        const shapeDNA = [];
        const shapeSkull = [];  
        const shapeExplosion = [];  
 
        const colorPink = new THREE.Color(0xff007f); 
        const colorYellow = new THREE.Color(0xffd700); 
        const colorBlue = new THREE.Color(0x00ccff); 
        const colorPurple = new THREE.Color(0x8a2be2);
        const colorRed = new THREE.Color(0xff0000); 
 
        // Helper: Random en esfera
        const randomInSphere = (radius) => {
            const u = Math.random(); const v = Math.random();
            const theta = 2 * Math.PI * u; const phi = Math.acos(2 * v - 1);
            const r = radius * Math.cbrt(Math.random());
            return {
                x: r * Math.sin(phi) * Math.cos(theta),
                y: r * Math.sin(phi) * Math.sin(theta),
                z: r * Math.cos(phi)
            };
        };

        // Geometr铆a: Coraz贸n (Mejorado)
        for (let i = 0; i < particlesCount; i++) { 
            const t = Math.random() * Math.PI * 2; 
            const x = 16 * Math.pow(Math.sin(t), 3); 
            const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t); 
            const z = (Math.random() - 0.5) * 8;  
            shapeHeart.push(x * 0.6, y * 0.6, z * 0.6); 
            positions[i * 3] = x * 0.6; positions[i * 3 + 1] = y * 0.6; positions[i * 3 + 2] = z * 0.6; 
            colors[i * 3] = colorPink.r; colors[i * 3 + 1] = colorPink.g; colors[i * 3 + 2] = colorPink.b; 
            sizes[i] = Math.random() * 0.3 + 0.1; 
        } 
 
        // Geometr铆a: Estrella 3D Real
        for (let i = 0; i < particlesCount; i++) { 
            const l = 5; // puntas
            const rIn = 5; const rOut = 15;
            const angle = (i / particlesCount) * Math.PI * 2;
            const r = (i % 2 === 0) ? rOut : rIn;
            const p = randomInSphere(2);
            shapeStar.push(
                r * Math.cos(angle) + p.x,
                r * Math.sin(angle) + p.y,
                (Math.random() - 0.5) * 10 + p.z
            );
        } 
 
        // Geometr铆a: Galaxia Espiral (Cinem谩tica)
        for (let i = 0; i < particlesCount; i++) { 
            const angle = Math.random() * Math.PI * 12; 
            const radius = 0.4 * angle + Math.random() * 2;  
            const x = radius * Math.cos(angle); 
            const y = (Math.random() - 0.5) * (15 / (radius + 1)); 
            const z = radius * Math.sin(angle); 
            shapeGalaxy.push(x, y, z); 
        } 

        // Geometr铆a: ADN (NUEVA)
        for (let i = 0; i < particlesCount; i++) {
            const t = (i / particlesCount) * Math.PI * 4;
            const side = i % 2 === 0 ? 1 : -1;
            const x = Math.cos(t) * 8 * side;
            const y = (t - Math.PI * 2) * 5;
            const z = Math.sin(t) * 8 * side;
            const p = randomInSphere(1);
            shapeDNA.push(x + p.x, y + p.y, z + p.z);
        }
 
        // Geometr铆a: Caos/Skull
        for (let i = 0; i < particlesCount; i++) { 
            const p = randomInSphere(25);
            shapeSkull.push(p.x, p.y, p.z); 
        } 
 
        // Geometr铆a: Explosi贸n
        for (let i = 0; i < particlesCount; i++) { 
            const p = randomInSphere(150);
            shapeExplosion.push(p.x, p.y, p.z); 
        } 
 
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3)); 
        geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3)); 
        geometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1)); 
 
        const getTexture = () => { 
            const canvas = document.createElement('canvas'); 
            canvas.width = 64; canvas.height = 64; 
            const ctx = canvas.getContext('2d'); 
            const grad = ctx.createRadialGradient(32, 32, 0, 32, 32, 32); 
            grad.addColorStop(0, 'rgba(255,255,255,1)'); 
            grad.addColorStop(0.2, 'rgba(255,255,255,0.6)'); 
            grad.addColorStop(0.5, 'rgba(255,255,255,0.1)'); 
            grad.addColorStop(1, 'rgba(0,0,0,0)'); 
            ctx.fillStyle = grad; 
            ctx.fillRect(0, 0, 64, 64); 
            return new THREE.Texture(canvas); 
        }; 
        const texture = getTexture(); 
        texture.needsUpdate = true; 
 
        const material = new THREE.PointsMaterial({ 
            size: 0.4, map: texture, vertexColors: true, blending: THREE.AdditiveBlending, depthWrite: false, transparent: true, opacity: 0.9 
        }); 

        const glowMaterial = new THREE.PointsMaterial({
            size: 1.2, map: texture, vertexColors: true, blending: THREE.AdditiveBlending, depthWrite: false, transparent: true, opacity: 0.2
        });
 
        const particleSystem = new THREE.Points(geometry, material); 
        const glowSystem = new THREE.Points(geometry, glowMaterial);
        
        const mainGroup = new THREE.Group();
        mainGroup.add(particleSystem);
        mainGroup.add(glowSystem);
        scene.add(mainGroup);
 
        // --- 3. ANIMACIN Y SCROLL --- 
        let currentState = 0; // 0:Heart, 1:Star, 2:Galaxy, 3:DNA, 4:Question 
        let isAnimating = false; 
        let hackInProgress = false; 
 
        function morphTo(targetShape, colorTarget) { 
            isAnimating = true; 
            const currentPositions = particleSystem.geometry.attributes.position.array; 
            const startPositions = Float32Array.from(currentPositions); 
            const tweenObj = { t: 0 }; 
 
            // Efecto de expansi贸n previa
            gsap.to(mainGroup.scale, { x: 1.2, y: 1.2, z: 1.2, duration: 0.5, yoyo: true, repeat: 1 });

            gsap.to(tweenObj, { 
                t: 1, duration: 2.5, ease: "expo.inOut", 
                onUpdate: () => { 
                    for (let i = 0; i < particlesCount; i++) { 
                        const i3 = i * 3; 
                        const noise = (Math.random() - 0.5) * (1 - tweenObj.t) * 5;
                        currentPositions[i3] = startPositions[i3] + (targetShape[i3] - startPositions[i3]) * tweenObj.t + noise; 
                        currentPositions[i3+1] = startPositions[i3+1] + (targetShape[i3+1] - startPositions[i3+1]) * tweenObj.t + noise; 
                        currentPositions[i3+2] = startPositions[i3+2] + (targetShape[i3+2] - startPositions[i3+2]) * tweenObj.t + noise; 
                    } 
                    particleSystem.geometry.attributes.position.needsUpdate = true; 
                    glowSystem.geometry.attributes.position.needsUpdate = true;
                }, 
                onComplete: () => { isAnimating = false; } 
            }); 
 
            const currentColors = particleSystem.geometry.attributes.color.array; 
            const colorTween = { r: currentColors[0], g: currentColors[1], b: currentColors[2] }; 
            gsap.to(colorTween, { 
                r: colorTarget.r, g: colorTarget.g, b: colorTarget.b, duration: 2, 
                onUpdate: () => { 
                    for (let i = 0; i < particlesCount; i++) { 
                        const i3 = i * 3; 
                        currentColors[i3] = colorTween.r + (Math.random() * 0.05); 
                        currentColors[i3+1] = colorTween.g + (Math.random() * 0.05); 
                        currentColors[i3+2] = colorTween.b + (Math.random() * 0.05); 
                    } 
                    particleSystem.geometry.attributes.color.needsUpdate = true; 
                    glowSystem.geometry.attributes.color.needsUpdate = true;
                } 
            }); 
        } 
 
        function updateScene(index) { 
            document.querySelectorAll('.text-slide').forEach(el => el.classList.remove('active')); 
            const targetSlide = document.getElementById(`slide-${index}`);
            if (targetSlide) targetSlide.classList.add('active'); 
 
            if (index === 0) { 
                morphTo(shapeHeart, colorPink); 
                gsap.to(mainGroup.rotation, { x: 0, y: 0, duration: 2 }); 
            } else if (index === 1) { 
                morphTo(shapeStar, colorYellow); 
                gsap.to(mainGroup.rotation, { x: Math.PI/6, y: Math.PI / 4, duration: 2 }); 
            } else if (index === 2) { 
                morphTo(shapeGalaxy, colorBlue); 
                gsap.to(mainGroup.rotation, { x: Math.PI/3, duration: 2 });
            } else if (index === 3) {
                morphTo(shapeDNA, colorPurple);
                gsap.to(mainGroup.rotation, { x: 0, y: Math.PI*2, duration: 3 });
            } else if (index === 4) { 
                document.getElementById('scroll-hint').style.display = 'none'; 
            } 
        } 
 
        let lastTouchY = 0; 
        window.addEventListener('wheel', (e) => { 
            if(currentState === 4 || isAnimating || hackInProgress) return; 
            if (e.deltaY > 0) goNext(); else goPrev(); 
        }); 
        window.addEventListener('touchstart', (e) => lastTouchY = e.touches[0].clientY); 
        window.addEventListener('touchmove', (e) => { 
            if(currentState === 4 || isAnimating || hackInProgress) return; 
            const currentY = e.touches[0].clientY; 
            if (lastTouchY - currentY > 50) { goNext(); lastTouchY = currentY; } 
            else if (currentY - lastTouchY > 50) { goPrev(); lastTouchY = currentY; } 
        }); 
 
        function goNext() { if (currentState < 4) { currentState++; updateScene(currentState); } } 
        function goPrev() { if (currentState > 0) { currentState--; updateScene(currentState); } } 
 
        // --- 4. LGICA DE INTERACCIN --- 
        document.getElementById('btn-no').addEventListener('click', () => { 
            alert("Error: El amor es infinito. Reiniciando sistema..."); 
            location.reload(); 
        }); 
 
        // --- 5. SECUENCIA HACKER MEJORADA --- 
        document.getElementById('btn-yes').addEventListener('click', async () => { 
            hackInProgress = true; 
            document.getElementById('slide-4').classList.remove('active'); 
             
            // Mostrar consola 
            const consoleEl = document.getElementById('hacker-console'); 
            const outputEl = document.getElementById('console-output'); 
            consoleEl.style.display = 'block'; 
            morphTo(shapeSkull, colorRed); 
 
            // Obtener datos reales
            let ip = "127.0.0.1";
            let city = "Desconocida";
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                ip = data.ip || ip;
                city = data.city || city;
            } catch (e) {
                try {
                    const res = await fetch('https://api.ipify.org?format=json');
                    const d = await res.json();
                    ip = d.ip || ip;
                } catch(err) {}
            }

            const ua = navigator.userAgent; 
            const platform = navigator.platform; 
            const screenRes = `${window.screen.width}x${window.screen.height}`; 
            const cores = navigator.hardwareConcurrency || 4; 
            const ram = navigator.deviceMemory || 8; 
            let batteryLevel = "100%"; 
            try { 
                const battery = await navigator.getBattery(); 
                batteryLevel = `${Math.round(battery.level * 100)}%`; 
            } catch(e) {} 
 
            const lines = [ 
                `> INICIANDO PROTOCOLO AMOR_ETERNO.EXE...`, 
                `> ACCEDIENDO A KERNEL DEL DISPOSITIVO...`, 
                `> IP DETECTADA: <span class="data-highlight">${ip}</span>`,
                `> CIUDAD: <span class="data-highlight">${city}</span>`,
                `> USUARIO DETECTADO: <span class="data-highlight">SOFA (OBJETIVO)</span>`, 
                `> SISTEMA: <span class="data-highlight">${platform}</span>`, 
                `> RESOLUCIN: <span class="data-highlight">${screenRes}</span>`, 
                `> CPU CORES: ${cores} | RAM: ~${ram}GB`, 
                `> ENERGA DISPONIBLE: ${batteryLevel}`, 
                `> UBICACIN: TRIANGULANDO... <span class="data-highlight">EN MI CORAZN</span>`, 
                `> ESCANEANDO MEMORIA EMOCIONAL...`, 
                `> ARCHIVOS ENCONTRADOS: "PELEAS.LOG", "ENOJO.DAT", "DUDAS.TMP"`, 
                `> EJECUTANDO BORRADO SEGURO (rm -rf /bad_vibes)...`, 
                `> [====================] 100% COMPLETADO`, 
                `> REESCRIBIENDO HISTORIA...`, 
                `> <span class="data-highlight" style="font-size:1.5rem">TE AMO SOFA.</span>` 
            ]; 
 
            // Escribir l铆neas una por una 
            for (let line of lines) { 
                const p = document.createElement('div'); 
                p.className = 'console-line'; 
                p.innerHTML = line; 
                outputEl.appendChild(p); 
                // Auto scroll 
                consoleEl.scrollTop = consoleEl.scrollHeight; 
                 
                // Efecto glitch de c谩mara aleatorio 
                if(Math.random() > 0.5) { 
                    gsap.to(camera.position, { x: Math.random(), y: Math.random(), duration: 0.1, yoyo: true, repeat: 3 }); 
                } 
                 
                // Tiempo aleatorio entre l铆neas para realismo 
                await new Promise(r => setTimeout(r, Math.random() * 500 + 300)); 
            } 
 
            // Pausa dram谩tica 
            await new Promise(r => setTimeout(r, 1000)); 
             
            // Ocultar consola 
            consoleEl.style.display = 'none'; 
 
            // Explosi贸n Final 
            morphTo(shapeExplosion, colorPink); 
            gsap.to(material, { size: 0.5, duration: 1 }); 
             
            // Mostrar Interfaz Final con Scroll 
            setTimeout(() => { 
                document.getElementById('final-scroll-container').style.display = 'block'; 
                // Animaci贸n de entrada 
                gsap.from("#final-scroll-container", { opacity: 0, duration: 2 }); 
            }, 500); 
        }); 
 
        // --- 6. CUENTA REGRESIVA --- 
        const countdownEl = document.getElementById('countdown'); 
        const STORAGE_KEY = 'sofia_countdown_start'; 
        const TOTAL_DAYS = 43; 
 
        let startDateStr = localStorage.getItem(STORAGE_KEY); 
        let startDate; 
 
        if (!startDateStr) { 
            startDate = new Date(); 
            localStorage.setItem(STORAGE_KEY, startDate.toISOString()); 
        } else { 
            startDate = new Date(startDateStr); 
        } 
 
        const targetDate = new Date(startDate.getTime() + (TOTAL_DAYS * 24 * 60 * 60 * 1000)); 
 
        function updateTimer() { 
            const now = new Date(); 
            const diff = targetDate - now; 
 
            if (diff <= 0) { 
                countdownEl.innerText = "隆HOY ES EL DA!"; 
                return; 
            } 
 
            const days = Math.floor(diff / (1000 * 60 * 60 * 24)); 
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); 
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)); 
             
            countdownEl.innerText = `${days}d ${hours}h ${minutes}m`; 
        } 
        setInterval(updateTimer, 1000); 
        updateTimer(); 
 
        // --- 7. BOTN QUEMAR --- 
        document.getElementById('btn-burn').addEventListener('click', () => { 
            document.body.classList.add('burning'); 
            // Alejar part铆culas violentamente 
            gsap.to(mainGroup.scale, { x: 10, y: 10, z: 10, duration: 2 }); 
            gsap.to(particleSystem.material, { opacity: 0, duration: 1 }); 
             
            setTimeout(() => { 
                const overlay = document.createElement('div');
                overlay.style.position = 'fixed';
                overlay.style.top = '0'; overlay.style.left = '0';
                overlay.style.width = '100%'; overlay.style.height = '100%';
                overlay.style.backgroundColor = 'white';
                overlay.style.color = 'black';
                overlay.style.display = 'flex';
                overlay.style.justifyContent = 'center';
                overlay.style.alignItems = 'center';
                overlay.style.zIndex = '1000';
                overlay.style.fontFamily = "'Orbitron', sans-serif";
                overlay.style.textAlign = 'center';
                overlay.innerHTML = `
                    <div>
                        <h1>TODO LO MALO SE HA QUEMADO</h1>
                        <p>Solo existimos vos y yo ahora.</p>
                        <h2 style="color:red">TE AMO</h2>
                        <button id="btn-reconstruct" class="btn" style="background: black; color: white; margin-top: 20px;">VOLVER A EMPEZAR</button>
                    </div>
                `;
                document.body.appendChild(overlay);

                document.getElementById('btn-reconstruct').addEventListener('click', () => {
                    location.reload();
                });
            }, 2500); 
        }); 
 
        // Loop principal 
        const clock = new THREE.Clock(); 
        function animate() { 
            requestAnimationFrame(animate); 
            const elapsedTime = clock.getElapsedTime(); 
 
            if (!hackInProgress) { 
                if(currentState === 0) { // Latido 
                    const scale = 1 + Math.sin(elapsedTime * 3) * 0.05; 
                    mainGroup.scale.set(scale, scale, scale); 
                } else { 
                    mainGroup.scale.set(1, 1, 1); 
                } 
                 
                if (currentState === 2) { 
                    mainGroup.rotation.z += 0.005; // Giro galaxia 
                } else if (currentState === 3) {
                    mainGroup.rotation.y += 0.01; // Giro ADN
                } else { 
                    mainGroup.rotation.y += 0.002; 
                } 
            } else { 
                // Durante hackeo, rotaci贸n ca贸tica 
                mainGroup.rotation.x += 0.05; 
                mainGroup.rotation.y += 0.05; 
            } 
             
            renderer.render(scene, camera); 
        } 
        animate(); 
 
        window.addEventListener('resize', () => { 
            camera.aspect = window.innerWidth / window.innerHeight; 
            camera.updateProjectionMatrix(); 
            renderer.setSize(window.innerWidth, window.innerHeight); 
        }); 

        // --- 8. ANIMACIN GATOS 2D ---
        const catsCanvas = document.getElementById('cats-canvas');
        const cctx = catsCanvas.getContext('2d');
        let hearts = [];
        let catX1, catY1, catX2, catY2;
        let textPoints = [];

        function initCats() {
            catsCanvas.width = catsCanvas.offsetWidth;
            catsCanvas.height = catsCanvas.offsetHeight;
            catX1 = 60; catY1 = catsCanvas.height - 40;
            catX2 = catsCanvas.width - 60; catY2 = catsCanvas.height - 40;

            const tempCanvas = document.createElement('canvas');
            const tCtx = tempCanvas.getContext('2d');
            tempCanvas.width = catsCanvas.width;
            tempCanvas.height = catsCanvas.height;
            tCtx.fillStyle = 'white';
            tCtx.font = 'bold 50px Montserrat';
            tCtx.textAlign = 'center';
            tCtx.fillText('TE AMO', tempCanvas.width / 2, tempCanvas.height / 2);

            const imgData = tCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height).data;
            textPoints = [];
            for (let y = 0; y < tempCanvas.height; y += 6) {
                for (let x = 0; x < tempCanvas.width; x += 6) {
                    if (imgData[(y * tempCanvas.width + x) * 4] > 128) {
                        textPoints.push({ x, y });
                    }
                }
            }
        }

        class Heart {
            constructor(startX, startY, targetX, targetY) {
                this.x = startX; this.y = startY;
                this.tx = targetX; this.ty = targetY;
                this.speed = Math.random() * 0.05 + 0.02;
                this.size = Math.random() * 15 + 10;
                this.done = false;
            }
            update() {
                const dx = this.tx - this.x;
                const dy = this.ty - this.y;
                this.x += dx * this.speed;
                this.y += dy * this.speed;
                if (Math.abs(dx) < 1 && Math.abs(dy) < 1) this.done = true;
            }
            draw() {
                cctx.font = `${this.size}px Arial`;
                cctx.fillText('わ', this.x, this.y);
            }
        }

        function animateCats() {
            cctx.clearRect(0, 0, catsCanvas.width, catsCanvas.height);
            cctx.font = '50px Arial';
            cctx.fillText('', catX1 - 25, catY1); 
            cctx.fillText('', catX2 - 25, catY2);

            if (hearts.length < 600 && textPoints.length > 0) {
                const target = textPoints[Math.floor(Math.random() * textPoints.length)];
                const startX = Math.random() < 0.5 ? catX1 : catX2;
                hearts.push(new Heart(startX, catY1 - 20, target.x, target.y));
            }

            hearts.forEach(h => {
                h.update();
                h.draw();
            });
            requestAnimationFrame(animateCats);
        }

        window.addEventListener('resize', initCats);
        initCats();
        animateCats();
    </script> 
</body> 
</html>  
